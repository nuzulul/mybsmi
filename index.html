<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#2196f3">
  <meta http-equiv="Content-Security-Policy" content="default-src * 'self' 'unsafe-inline' 'unsafe-eval' data: blob:">
  <title>MyBSMI</title>
  <link rel="stylesheet" href="https://unpkg.com/framework7@7.1.2/framework7-bundle.min.css">
  <link rel="stylesheet" href="https://unpkg.com/framework7-icons">
  <script src='https://www.google.com/recaptcha/api.js'></script>
  <style>
    :root {
      --f7-panel-transition-duration: 250ms;
      --f7-bars-bg-color: #fff;
      --f7-page-bg-color: #f2f3f8;
      --f7-navbar-border-color: transparent;
      --f7-navbar-shadow-image: linear-gradient(to bottom,
        rgba(0,0,0,0.15) 0%,
        rgba(0,0,0,0.08) 40%,
        rgba(0,0,0,0.04) 50%,
        rgba(0,0,0,0) 90%,
        rgba(0,0,0,0) 100%
      );

    }
    .aurora {
      --f7-list-item-text-font-size: 13px;
      --f7-list-item-text-line-height: 18px;
      --f7-panel-collapsed-width: 44px;
    }
    .ios {
      --f7-panel-collapsed-width: 58px;
    }
    .md {
      --f7-panel-collapsed-width: 60px;
    }
    
    @media (min-width: 1024px) {
      .panel-open[data-panel="left"] {
        display: none !important;
      }
    }
    .panel-left.dark {
      --f7-list-chevron-icon-color: rgba(255,255,255,0.4);
    }
    .panel-left .list .icon,
    .panel-left .treeview .icon {
      color: #fff;
    }
    .panel-left .active-link {
      background-color: var(--f7-theme-color);
      --f7-list-link-hover-bg-color: var(--f7-theme-color-tint);
      --f7-list-link-pressed-bg-color: var(--f7-theme-color-shade);
    }

    .dashboard-cards {
      --f7-card-margin-vertical: 0px;
      --f7-card-margin-horizontal: 0px;
      --f7-card-box-shadow: 0px 0px 13px 0px rgba(82, 63, 105, 0.1);
    }

    .product-image {
      width: 56px;
      height: 56px;
      border-radius: 4px;
    }

    .avatar {
      width: 28px;
      height: 28px;
      border-radius: 50%;
    }

    @media (min-width: 768px) {
      .card-content.scrollable {
        overflow: auto;
        -webkit-overflow-scrolling: touch;
        height: 260px;
      }
    }

    .timeline-item-divider {
      background: var(--f7-theme-color);
    }
    .timeline-item-divider:after,
    .timeline-item-divider:before {
      width: 2px;
    }

    @media (min-width: 768px) {
      .events-col .card {
        height: 100%;
        display: flex;
        flex-direction: column;
      }
      .events-col .card-content {
        flex-shrink: 10;
        min-height: 0;
        overflow: auto;
        -webkit-overflow-scrolling: touch;
      }
    }
    @media (max-width: 767px) {
      .events-col {
        height: auto !important;
      }
    }

    .tasks-list {
      --f7-list-item-title-white-space: normal;
      --f7-list-item-title-font-weight: 500;
    }
    .aurora .tasks-list {
      --f7-list-item-padding-vertical: 8px;
      --f7-badge-size: 14px;
    }
    .tasks-list .item-media {
      width: 4px;
      min-width: 0 !important;
      margin-right: 5px;
    }
    .tasks-list .category-icon {
      height: 24px;
      width: 4px;
      border-radius: 2px;
      background: var(--f7-theme-color);
    }
    
    img {
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg width='1200' height='630' viewBox='0 0 1200 630' fill='none' xmlns='http://www.w3.org/2000/svg'%3e%3crect width='1200' height='630' fill='%23DFE5EC' fill-opacity='0.5'/%3e%3cpath d='M760 175H440C428.94 175 420 183.94 420 195V435C420 446.039 428.94 455 440 455H760C771.06 455 780 446.04 780 435V195C780 183.961 771.06 175 760 175V175ZM664.999 245.003C678.799 245.003 689.999 256.203 689.999 270.003C689.999 283.803 678.799 295.002 664.999 295.002C651.199 295.002 639.999 283.803 639.999 270.003C639.999 256.203 651.199 245.003 664.999 245.003ZM479.998 395.007L546.278 242.627L621.657 364.666L686.277 332.565L719.997 395.006H479.999L479.998 395.007Z' fill='%23ACBCCD' fill-opacity='0.5'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: center;
    background-size: cover;
    }

  </style>
</head>
<body class="color-theme-red">
  <div id="app">
    <div class="panel panel-left panel-reveal panel-init dark" data-visible-breakpoint="1024" data-collapsed-breakpoint="1">
      <div class="view">
        <div class="page">
          <div class="list">
            <ul>
              <li>
                <a href="/" class="item-content item-link active-link panel-close">
                  <div class="item-media">
                    <i class="icon f7-icons">square_grid_2x2_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Dashboard</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>

          <div class="list">
            <ul>
              <li>
                <a href="/biodata/" class="item-content item-link panel-close mybsmi-profile">
                  <div class="item-media">
                    <i class="icon f7-icons">person_circle_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Biodata</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>

          <div class="list">
            <ul>
              <li>
                <a href="/ekta/" class="item-content item-link panel-close mybsmi-ekta">
                  <div class="item-media">
                    <i class="icon f7-icons">creditcard_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">e-KTA</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>
<!--
          <div class="list">
            <ul>
              <li>
                <a href="/riwayat/" class="item-content item-link panel-close">
                  <div class="item-media">
                    <i class="icon f7-icons">clock</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Riwayat</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>
-->
<!--
          <div class="list">
            <ul>
              <li>
                <a href="#" class="item-content item-link panel-close my-logout">
                  <div class="item-media">
                    <i class="icon f7-icons">power</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Logout</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>
-->

          <div class="list mybsmi-verifikatormenu" style="display:none">
            <ul>
              <li>
                <a href="/verifikator/" class="item-content item-link panel-close">
                  <div class="item-media">
                    <i class="icon f7-icons">checkmark_2</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Verifikator</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>

          <div class="list mybsmi-adminmenu" style="display:none">
            <ul>
              <li>
                <a href="/admin/" class="item-content item-link panel-close">
                  <div class="item-media">
                    <i class="icon f7-icons">chart_pie_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Admin</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>

<!--
          <div class="list">
            <ul>
              <li>
                <a href="#" class="item-content item-link">
                  <div class="item-media">
                    <i class="icon f7-icons">folder_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Categories</div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#" class="item-content item-link">
                  <div class="item-media">
                    <i class="icon f7-icons">cart_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Products</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>

          <div class="list">
            <ul>
              <li>
                <a href="#" class="item-content item-link">
                  <div class="item-media">
                    <i class="icon f7-icons">bag_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Sales</div>
                  </div>
                </a>
              </li>
              <li>
                <a href="#" class="item-content item-link">
                  <div class="item-media">
                    <i class="icon f7-icons">graph_circle_fill</i>
                  </div>
                  <div class="item-inner">
                    <div class="item-title">Analytics</div>
                  </div>
                </a>
              </li>
            </ul>
          </div>

          <div class="block block-strong no-padding-horizontal padding-vertical-half">
            <div class="treeview">
              <div class="treeview-item">
                <div class="treeview-item-root treeview-item-toggle">
                  <div class="treeview-toggle"></div>
                  <div class="treeview-item-content">
                    <div class="treeview-item-label">Departments</div>
                  </div>
                </div>
                <div class="treeview-item-children">
                  <div class="treeview-item">
                    <a href="#" class="treeview-item-root">
                      <div class="treeview-item-content">
                        <div class="treeview-item-label">New York</div>
                      </div>
                    </a>
                  </div>
                  <div class="treeview-item">
                    <a href="#" class="treeview-item-root">
                      <div class="treeview-item-content">
                        <div class="treeview-item-label">London</div>
                      </div>
                    </a>
                  </div>
                  <div class="treeview-item">
                    <a href="#" class="treeview-item-root">
                      <div class="treeview-item-content">
                        <div class="treeview-item-label">Beijing</div>
                      </div>
                    </a>
                  </div>
                  <div class="treeview-item">
                    <a href="#" class="treeview-item-root">
                      <div class="treeview-item-content">
                        <div class="treeview-item-label">Tokyo</div>
                      </div>
                    </a>
                  </div>
                </div>
              </div>
            </div>
          </div>
-->
          
          
          
        </div>
      </div>
    </div>
    <div class="view view-main view-init">
      <div class="page">
        <div class="navbar">
          <div class="navbar-bg"></div>
          <div class="navbar-inner">
            <div class="left">
              <a class="link panel-open icon-only" data-panel="left">
                <i class="icon f7-icons">bars</i>
              </a>
            </div>
            <div class="title">Dashboard</div>
            <div class="right">
              <a class="link popover-open" data-popover=".profile-popover">
                <span class="margin-right-half"></span>
                <img src="avatar.png" class="avatar mybsmi-avatar"><span class="badge color-blue mybsmi-avatar-badge" style="left:-8px;bottom:-5px;display:none;"><i class="icon f7-icons" style="font-size:12px;">checkmark_seal</i></span>
              </a>
            </div>
            <div class="title-large">
              <div class="title-large-text display-flex align-items-center">
                <i class="icon f7-icons margin-right-half" style="font-size: 24px">square_grid_2x2_fill</i>
                <span>Dashboard</span>
              </div>
            </div>
          </div>
        </div>
        <div class="popover profile-popover">
          <div class="popover-inner">
            <h3 class="text-align-center mybsmi-currentusernama">User</h3>
            <div class="list no-hairlines no-hairlines-between">
              <ul>
                <li>
                  <a href="/riwayat/" class="item-link item-content link popover-close" data-popover=".profile-popover">
                    <div class="item-media">
                      <i class="icon f7-icons">clock</i>
                    </div>
                    <div class="item-inner">
                      <div class="item-title">Riwayat</div>
                    </div>
                  </a>
                </li>
                <li>
                  <a href="/pesan/" class="item-link item-content link popover-close" data-popover=".profile-popover">
                    <div class="item-media">
                      <i class="icon f7-icons">envelope_fill</i>
                    </div>
                    <div class="item-inner">
                      <div class="item-title">Pesan</div>
                    </div>
                  </a>
                </li>
              </ul>
            </div>

            <div class="list no-hairlines no-hairlines-between margin-bottom">
              <ul>
                <li>
                  <a href="#" class="item-link item-content my-logout">
                    <div class="item-media">
                      <i class="icon f7-icons">exit_fill</i>
                    </div>
                    <div class="item-inner">
                      <div class="item-title">Logout</div>
                    </div>
                  </a>
                </li>
              </ul>
            </div>

          </div>
        </div>
        <div class="page-content">
          <div class="dashboard-cards">
            <div class="row margin-horizontal">
              
              <div class="col-100 medium-66 margin-top charts-col">
                <div class="row">
                  <div class="col-50">
                    <div class="card">
                      <div class="card-header">Cabang</div>
                      <div class="card-content card-content-padding text-align-center">
                        <div
                          class="gauge gauge-init"
                          id="mybsmi-cabang" 
                          data-type="circle"
                          data-value="0.00"
                          data-value-text="0"
                          data-label-text="Kota/Kabupaten"
                          data-value-text-color="#f44336"
                          data-border-color="#f44336"
                          data-border-width="30"
                        ></div>
                      </div>
                    </div>
                  </div>
                  <div class="col-50">
                    <div class="card">
                      <div class="card-header">Relawan</div>
                      <div class="card-content card-content-padding text-align-center">
                        <div
                          class="gauge gauge-init"
                          id="mybsmi-relawan" 
                          data-type="circle"
                          data-value="0.00"
                          data-value-text="0"
                          data-label-text="Orang"
                          data-value-text-color="#ff9800"
                          data-border-color="#ff9800"
                          data-border-width="30"
                        ></div>
                      </div>
                    </div>
                  </div>

                </div>
              </div>
              
              
<!--              
              <div class="col-100 medium-33 margin-top events-col">
                <div class="card">
                  <div class="card-header">Latest Events</div>
                  <div class="card-content card-content-padding">
                    <div class="timeline no-margin no-padding">
                      <div class="timeline-item">
                        <div class="timeline-item-date">10:00</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolor fugiat ipsam hic</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">11:00</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">Another text goes here</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">14:45</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolor fugiat ipsam hic porro enim, accusamus perferendis, quas commodi alias quaerat eius nemo deleniti. Odio quasi quos quis iure, aperiam pariatur?</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">16:24</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">One more text here</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">17:11</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolor fugiat ipsam hic</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">17:28</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">Another text goes here</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">18:00</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolor fugiat ipsam hic porro enim, accusamus perferendis, quas commodi alias quaerat eius nemo deleniti. Odio quasi quos quis iure, aperiam pariatur?</div>
                      </div>
                      <div class="timeline-item">
                        <div class="timeline-item-date">19:19</div>
                        <div class="timeline-item-divider"></div>
                        <div class="timeline-item-content">One more text here</div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
-->              
              
              
              
            </div>
            
<!--            <div class="row margin-horizontal">
              <div class="col-100 medium-66 margin-top">
                <div class="card">
                  <div class="card-header">
                    <span>Best Sellers</span>
                    <div class="segmented">
                      <a class="button button-small button-outline tab-link-active tab-link" style="width:auto">Today</a>
                      <a class="button button-small button-outline tab-link" style="width:auto">Week</a>
                      <a class="button button-small button-outline tab-link" style="width:auto">Month</a>
                    </div>
                  </div>
                  <div class="card-content card-content-padding scrollable">
                    <div class="list media-list">
                      <ul>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/1">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Logo Design</div>
                              <div class="item-after">12 sales</div>
                            </div>
                            <div class="item-text">Design</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/2">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Website Design</div>
                              <div class="item-after">10 sales</div>
                            </div>
                            <div class="item-text">Design</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/3">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">PSD to HTML</div>
                              <div class="item-after">8 sales</div>
                            </div>
                            <div class="item-text">Coding</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/4">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Business Card</div>
                              <div class="item-after">7 sales</div>
                            </div>
                            <div class="item-text">Design</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/5">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Sketch to HTML</div>
                              <div class="item-after">5 sales</div>
                            </div>
                            <div class="item-text">Coding</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/5">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Vecotor assets</div>
                              <div class="item-after">4 sales</div>
                            </div>
                            <div class="item-text">Design</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/6">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">50 Twitter Folowers Pack</div>
                              <div class="item-after">3 sales</div>
                            </div>
                            <div class="item-text">Social</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="product-image" src="https://placeimg.com/112/112/6">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">100 Twitter Folowers Pack</div>
                              <div class="item-after">2 sales</div>
                            </div>
                            <div class="item-text">Social</div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
-->

              
<!--
              <div class="col-100 medium-33 margin-top">
                <div class="card">
                  <div class="card-header">New Users</div>
                  <div class="card-content card-content-padding scrollable">
                    <div class="list media-list">
                      <ul>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=1">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">John Doe</div>
                            </div>
                            <div class="item-text">john@doe.com</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=2">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Jane Doe</div>
                            </div>
                            <div class="item-text">jane@doe.com</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=3">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Kate</div>
                            </div>
                            <div class="item-text">kate@athome.app</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=4">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Mary</div>
                            </div>
                            <div class="item-text">-</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=5">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Frame Work</div>
                            </div>
                            <div class="item-text">frame@work7.com</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=1">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">John Doe</div>
                            </div>
                            <div class="item-text">john@doe.com</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=2">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Jane Doe</div>
                            </div>
                            <div class="item-text">jane@doe.com</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=3">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Kate</div>
                            </div>
                            <div class="item-text">kate@athome.app</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=4">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Mary</div>
                            </div>
                            <div class="item-text">-</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=5">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Frame Work</div>
                            </div>
                            <div class="item-text">frame@work7.com</div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
-->




            <div class="row margin-horizontal margin-bottom">
              <div class="col-100 medium-66 margin-top">
                <div class="card data-table">
                  <div class="card-header">Statistik</div>
                  <div class="card-content">
                    <table>
                      <thead>
                        <tr>
                          <th class="label-cell">BSMI Provinsi</th>
                          <th class="numeric-cell">Relawan</th>
                        </tr>
                      </thead>
                      <tbody class="mybsmi-rekapitulasiprov">
                        <!--<tr>
                          <td class="label-cell">BSMI Kota Surabaya</td>
                          <td class="numeric-cell">1000</td>
                        </tr>-->
                      </tbody>
                    </table>
                    <table>
                      <thead>
                        <tr>
                          <th class="label-cell">BSMI Kota/Kabupaten</th>
                          <th class="numeric-cell">Relawan</th>
                        </tr>
                      </thead>
                      <tbody class="mybsmi-rekapitulasicabang">
                        <!--<tr>
                          <td class="label-cell">BSMI Kota Surabaya</td>
                          <td class="numeric-cell">1000</td>
                        </tr>-->
                      </tbody>
                    </table>
                    <div class="data-table-footer">
                      <!--<div class="data-table-rows-select">
                        Rows per page:
                        <div class="input input-dropdown input-with-value">
                          <select class="input-with-value">
                            <option value="5">5</option>
                            <option value="10">10</option>
                            <option value="25">25</option>
                            <option value="all">All</option>
                          </select>
                        </div>
                      </div>
                      <div class="data-table-pagination">
                        <span class="data-table-pagination-label">1-5 of 10</span>
                        <a href="#" class="link disabled">
                          <i class="icon icon-prev color-gray"></i>
                        </a>
                        <a href="#" class="link">
                          <i class="icon icon-next color-gray"></i>
                        </a>
                      </div>-->
                    </div>
                  </div>

                </div>
              </div>
            </div>



<!--
            <div class="row margin-horizontal margin-bottom">
              <div class="col-100 medium-33 margin-top">
                <div class="card">
                  <div class="card-header">Notifications</div>
                  <div class="card-content card-content-padding scrollable">
                    <div class="list media-list">
                      <ul>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-yellow">exclamationmark_triangle_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Server access error</div>
                              <div class="item-after">15:45</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-green">cart_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">New order received</div>
                              <div class="item-after">13:20</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-green">cart_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">New order received</div>
                              <div class="item-after">11:11</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-blue">person_circle_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">New user registered</div>
                              <div class="item-after">10:16</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-teal">document_text_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">New report uploaded</div>
                              <div class="item-after">02:00</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-blue">person_circle_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">New user registered</div>
                              <div class="item-after">Yesterday at 22:56</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <i class="icon f7-icons text-color-blue">person_circle_fill</i>
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">New user registered</div>
                              <div class="item-after">Yesterday at 20:10</div>
                            </div>
                            <div class="item-text">Lorem ipsum dolor sit amet, consectetuer edipiscing elit</div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
-->

<!--
              <div class="col-100 medium-33 margin-top">
                <div class="card">
                  <div class="card-header">Tasks</div>
                  <div class="card-content card-content-padding scrollable">
                    <div class="list tasks-list">
                      <ul>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-blue"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Prepare docs for meeting</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-blue"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add new HS spectrum module to Color Picker</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-orange"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add year/month selector to Calendar component</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-green"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add new experimental set</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-pink"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add learning mode to instruments set</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-blue"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Prepare docs for meeting</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-blue"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add new HS spectrum module to Color Picker</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-orange"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add year/month selector to Calendar component</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-green"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add new experimental set</div>
                            </div>
                          </label>
                        </li>
                        <li>
                          <label class="item-checkbox item-content">
                            <div class="item-media">
                              <span class="category-icon color-pink"></span>
                            </div>
                            <input type="checkbox"/>
                            <i class="icon icon-checkbox"></i>
                            <div class="item-inner">
                              <div class="item-title">Add learning mode to instruments set</div>
                            </div>
                          </label>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
-->

<!--
              <div class="col-100 medium-33 margin-top">
                <div class="card">
                  <div class="card-header">Support Tickets</div>
                  <div class="card-content card-content-padding scrollable">
                    <div class="list media-list" style="--f7-list-item-text-max-lines: 5">
                      <ul>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=1">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">John Doe</div>
                              <div class="item-after"><span class="badge color-blue">Pending</span></div>
                            </div>
                            <div class="item-subtitle">1 hour ago</div>
                            <div class="item-text">Lorem ipsum dolor sit amet,consectetuer edipiscing elit,sed diam nonummy nibh euismod tinciduntut laoreet doloremagna aliquam erat volutpat.</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=2">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Jane Doe</div>
                              <div class="item-after"><span class="badge color-green">Closed</span></div>
                            </div>
                            <div class="item-subtitle">6 hours ago</div>
                            <div class="item-text">Sed diam nonummy nibh euismod tinciduntut laoreet doloremagna aliquam erat volutpat.Ut wisi enim ad minim veniam,quis nostrud exerci tation ullamcorper.</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=3">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Kate</div>
                              <div class="item-after"><span class="badge color-green">Closed</span></div>
                            </div>
                            <div class="item-subtitle">1 day ago</div>
                            <div class="item-text">Lorem ipsum dolor sit amet,consectetuer edipiscing elit,sed diam nonummy nibh euismod tinciduntut laoreet doloremagna aliquam erat volutpat.</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=4">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Mary</div>
                              <div class="item-after"><span class="badge color-orange">Issue</span></div>
                            </div>
                            <div class="item-subtitle">3 days ago</div>
                            <div class="item-text">Sed diam nonummy nibh euismod tinciduntut laoreet doloremagna aliquam erat volutpat.Ut wisi enim ad minim veniam,quis nostrud exerci tation ullamcorper.</div>
                          </div>
                        </li>
                        <li class="item-content">
                          <div class="item-media">
                            <img class="avatar" src="https://i.pravatar.cc/56?u=5">
                          </div>
                          <div class="item-inner">
                            <div class="item-title-row">
                              <div class="item-title">Frame Work</div>
                              <div class="item-after"><span class="badge color-blue">Pending</span></div>
                            </div>
                            <div class="item-subtitle">5 days ago</div>
                            <div class="item-text">Lorem ipsum dolor sit amet,consectetuer edipiscing elit,sed diam nonummy nibh euismod tinciduntut laoreet doloremagna aliquam erat volutpat.</div>
                          </div>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
-->              
              
              
            
              
            </div>  
          </div>

        </div>
      </div>

<!--start login------------------------------------------------------------------------------->
    <form class="login-screen" id="my-login-screen">
      <div class="view">
        <div class="page">
          <div class="page-content login-screen-content">
            <div class="login-screen-title">Login</div>
            <div class="list">
              <ul>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Email</div>
                    <div class="item-input-wrap">
                      <input type="email" name="email" placeholder="Alamat email" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Password</div>
                    <div class="item-input-wrap">
                      <input type="password" name="password" placeholder="Password" minlength="10" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div style="padding:20px 20px;justify-content:center;align-items:center;display:flex;width:100%;">
                  <div class="g-recaptcha" data-sitekey="6LcP1RskAAAAANtjMoK9vf0tL37hI_uRIxsQm9-k" data-callback="grecaptcharesponse" data-expired-callback="grecaptchaexpired" data-size="normal"></div>
                  </div>
                <li>
              </ul>
            </div>
            <div class="list">
              <div class="block-footer"><a href="#" class="button button-raised button-fill login-button">Login</a><a href="#" class="item-link list-button login-screen-close" data-login-screen="#my-login-screen">Batal</a></div>
              <p style="font-size:12px;color:grey;text-align:center">Lupa password akun? <a href="" class="reset-password-open">Lupa Password</a></p>
            </div>
          </div>
        </div>
      </div>
    </form> 
<!--start login------------------------------------------------------------------------------->


<!--start aktivasi------------------------------------------------------------------------------->     
    <form class="login-screen" id="my-aktivasi-screen">
      <div class="view">
        <div class="page">
          <div class="page-content login-screen-content">
            <div class="login-screen-title">Aktivasi Akun</div>
            <div class="list">
              <ul>
                <li class="item-content item-input"><b>Akun Relawan</b>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Email *</div>
                    <div class="item-input-wrap">
                      <input type="email" name="email" placeholder="Alamat email" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Password *</div>
                    <div class="item-input-wrap">
                      <input type="password" name="password" placeholder="Password" minlength="10" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Konfirm Password *</div>
                    <div class="item-input-wrap">
                      <input type="password" name="konfirmpassword" placeholder="Konfirm Password" minlength="10" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input"><b>Data Relawan</b>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Nama Lengkap dan Gelar *</div>
                    <div class="item-input-wrap">
                      <input type="text" name="nama" placeholder="Nama lengkap dan gelar" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input smart-select smart-select-init" data-open-in="popover">
                  <div class="item-inner">
                    <div class="item-title item-label">Jenis Kelamin *</div>
                    <div class="item-after">-- Jenis Kelamin --</div>
                    <div class="item-input-wrap">
                                  <select name="jeniskelamin" required validate>
                                    <option value="" disabled selected>-- Jenis Kelamin --</option>
                                    <option value="Laki-Laki">Laki-laki</option>
                                    <option value="Perempuan">Perempuan</option>
                                  </select>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Tanggal Lahir *</div>
                    <div class="item-input-wrap">
                      <input type="text" name="tanggallahir" placeholder="Tanggal Lahir" readonly="readonly" class="calendar-input" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Alamat Lengkap Domisili *</div>
                    <div class="item-input-wrap">
                      <input type="text" name="alamatdomisili" placeholder="Alamat Lengkap Domisili" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input smart-select smart-select-init" data-open-in="popover">
                  <div class="item-inner">
                    <div class="item-title item-label">Profesi *</div>
                    <div class="item-after">-- Profesi --</div>
                    <div class="item-input-wrap">
                                  <select name="profesi" required validate>
                                    <option value="" disabled selected>-- Profesi --</option>
                                    <option value="Dokter Spesialis">Dokter Spesialis</option>
                                    <option value="Dokter Umum">Dokter Umum</option>
                                    <option value="Dokter Gigi">Dokter Gigi</option>
                                    <option value="Bidan">Bidan</option>
                                    <option value="Perawat">Perawat</option>
                                    <option value="Apoteker">Apoteker</option>
                                    <option value="Umum">Umum</option>
                                  </select>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input smart-select smart-select-init" data-open-in="popover">
                  <div class="item-inner">
                    <div class="item-title item-label">Golongan Darah *</div>
                    <div class="item-after">-- Golongan Darah --</div>
                    <div class="item-input-wrap">
                                  <select name="golongandarah" required validate>
                                    <option value="" disabled selected>-- Golongan Darah --</option>
                                    <option value="A">A</option>
                                    <option value="B">B</option>
                                    <option value="AB">AB</option>
                                    <option value="O">O</option>
                                    <option value="Tidak Tahu">Tidak Tahu</option>
                                  </select>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">No HP/Whatsapp *</div>
                    <div class="item-input-wrap">
                      <input type="number" name="nohp" placeholder="No HP/Whatsapp" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input smart-select smart-select-init" data-open-in="popover">
                  <div class="item-inner">
                    <div class="item-title item-label">Anggota Cabang *</div>
                    <div class="item-after">-- Cabang --</div>
                    <div class="item-input-wrap">
                                  <select name="cabang" required validate>
                                    <option value="" disabled selected>-- Cabang --</option>
                                    <option value="BSMI Jawa Timur">BSMI Jawa Timur</option>
                                    <option value="" disabled>-- ZONA 1 --</option>
                                    <option value="BSMI Kota Surabaya">BSMI Kota Surabaya</option>
                                    <option value="BSMI Kab Sidoarjo">BSMI Kab Sidoarjo</option>
                                    <option value="BSMI Kab Mojokerto">BSMI Kab Mojokerto</option>
                                    <option value="BSMI Kota Mojokerto">BSMI Kota Mojokerto</option>
                                    <option value="BSMI Kab Lamongan">BSMI Kab Lamongan</option>
                                    <option value="BSMI Kab Gresik">BSMI Kab Gresik</option>
                                    <option value="BSMI Kab Tuban">BSMI Kab Tuban</option>
                                    <option value="BSMI Kab Bojonegoro">BSMI Kab Bojonegoro</option>
                                    <option value="BSMI Kota Pasuruan">BSMI Kota Pasuruan</option>
                                    <option value="BSMI Kab Pasuruan">BSMI Kab Pasuruan</option>
                                    <option value="" disabled >-- ZONA 2 --</option>
                                    <option value="BSMI Kab Bangkalan">BSMI Kab Bangkalan</option>
                                    <option value="BSMI Kab Sampang">BSMI Kab Sampang</option>
                                    <option value="BSMI Kab Pamekasan">BSMI Kab Pamekasan</option>
                                    <option value="BSMI Kab Sumenep">BSMI Kab Sumenep</option>
                                    <option value="" disabled >-- ZONA 3 --</option>
                                    <option value="BSMI Kota Probolinggo">BSMI Kota Probolinggo</option>
                                    <option value="BSMI Kab Probolinggo">BSMI Kab Probolinggo</option>
                                    <option value="BSMI Kab Jember">BSMI Kab Jember</option>
                                    <option value="BSMI Kab Lumajang">BSMI Kab Lumajang</option>
                                    <option value="BSMI Kab Bondowoso">BSMI Kab Bondowoso</option>
                                    <option value="BSMI Kab Situbondo">BSMI Kab Situbondo</option>
                                    <option value="BSMI Kab Banyuwangi">BSMI Kab Banyuwangi</option>
                                    <option value="" disabled >-- ZONA 4 --</option>
                                    <option value="BSMI Kab Jombang">BSMI Kab Jombang</option>
                                    <option value="BSMI Kota Malang">BSMI Kota Malang</option>
                                    <option value="BSMI Kab Malang">BSMI Kab Malang</option>
                                    <option value="BSMI Kota Batu">BSMI Kota Batu</option>
                                    <option value="BSMI Kota Kediri">BSMI Kota Kediri</option>
                                    <option value="BSMI Kab Kediri">BSMI Kab Kediri</option>
                                    <option value="BSMI Kota Blitar">BSMI Kota Blitar</option>
                                    <option value="BSMI Kab Blitar">BSMI Kab Blitar</option>
                                    <option value="BSMI Kab Tulungagung">BSMI Kab Tulungagung</option>
                                    <option value="" disabled >-- ZONA 5 --</option>
                                    <option value="BSMI Kota Madiun">BSMI Kota Madiun</option>
                                    <option value="BSMI Kab Madiun">BSMI Kab Madiun</option>
                                    <option value="BSMI Kab Ngawi">BSMI Kab Ngawi</option>
                                    <option value="BSMI Kab Magetan">BSMI Kab Magetan</option>
                                    <option value="BSMI Kab Ponorogo">BSMI Kab Ponorogo</option>
                                    <option value="BSMI Kab Pacitan">BSMI Kab Pacitan</option>
                                    <option value="BSMI Kab Trenggalek">BSMI Kab Trenggalek</option>
                                    <option value="BSMI Kab Nganjuk">BSMI Kab Nganjuk</option>
                                  </select>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div class="item-inner">
                    <div class="item-title item-label">Tahun Bergabung *</div>
                    <div class="item-input-wrap">
                      <input type="number" name="tahun" placeholder="Tahun Bergabung" required validate>
                    </div>
                  </div>
                </li>
                <li class="item-content item-input">
                  <div style="padding:20px 20px;justify-content:center;align-items:center;display:flex;width:100%;">
                  <div id="mybsmi-grecaptchaaktivasi" class="g-recaptcha1" data-sitekey="6LcP1RskAAAAANtjMoK9vf0tL37hI_uRIxsQm9-k" data-callback="grecaptcharesponse" data-expired-callback="grecaptchaexpired"></div>
                  </div>
                <li>
              </ul>
            </div>
            <div class="list">
              <div class="block-footer"><a href="#" class="button button-raised button-fill register-button">AKTIVASI</a><a href="#" class="item-link list-button close-login-button login-screen-close" data-login-screen="#my-aktivasi-screen">Batal</a></div>
            </div>
          </div>
        </div>
      </div>
    </form>          
<!--end register------------------------------------------------------------------------------->     

          
<!--start overlay------------------------------------------------------------------------------->          
<div id="overlay-welcome" style="background: rgba(0, 0, 0, 0.8);position: fixed;z-index: 10000;align-items: center;justify-content: center;display: flex;bottom: 0;left: 0;right: 0;top: 0;    background-image: url();background-size: cover;background-position: center top;">
  <div style="background:#fff;display: flex;flex-direction:column;margin: auto;align-items: center;justify-content: center;padding:20px 20px;">
    <img src="https://1.bp.blogspot.com/-I9V1NyLtG68/XmJRZ_RhTJI/AAAAAAAADgI/wJiuL0Wnjvc2jyoV8AMRsIp1YvSQs1QXwCLcBGAsYHQ/s1600/Logo%2BBSMI%2B%2528vector%2529.png" style="width:200px;height:300px;object-fit: contain;background-image:none;">
    <p style="font-size:16px;font-weight:bold;text-align:center;width:300px;margin-top:15px;margin-bottom:2px;">MyBSMI</p>
    <p style="font-size:14px;font-weight:normal;text-align:center;width:300px;margin-top:0px;margin-bottom:15px;">Selamat Datang</br>Relawan BSMI Jawa Timur</p>
    <button class="button button-fill login-screen-open" data-login-screen="#my-login-screen" style="width:100px;">LOGIN</button>
    <!--<p style="font-size:12px;color:grey;tex-align:center">Belum punya akun? <a href="" class="login-screen-open" data-login-screen="#my-aktivasi-screen">Aktivasi</a></p>-->
    <p style="font-size:12px;color:grey;tex-align:center">Belum punya akun? <a href="" class="mybsmi-aktivasiscreen">Aktivasi</a></p>
  </div>
</div>
<!--end overlay------------------------------------------------------------------------------->


    </div>
  </div>




  <script src="https://unpkg.com/framework7@7.1.2/framework7-bundle.min.js"></script>
  <script src="https://unpkg.com/chart.js"></script>
<!--start script------------------------------------------------------------------------------->
<script>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

/////getparams/////////////////////////////////////////////////////////////////////////////
var getParams = function (url) {
	var params = {};
	var parser = document.createElement('a');
	parser.href = url;
	var query = parser.search.substring(1);
	var vars = query.split('&');
	for (var i = 0; i < vars.length; i++) {
		var pair = vars[i].split('=');
		params[pair[0]] = decodeURIComponent(pair[1]);
	}
	return params;
};
var params = getParams(window.location.href);
//////////////////////////////////////////////////////////////////////////////

var $$ = Dom7;

var mybsmiaktivasi = 'd426d702f89bac9fb66b22ede9593b62a447bf4154dfac317a72fcf4f168172a';
var grecaptcharesponsedata = '';
var isLocal = false;

if ((window.location.href.indexOf("localhost") > -1)||(window.location.href.indexOf("127.0.0.1") > -1)) 
{
console.log('local development');
isLocal = true;
var access_token = params.access_token;
var apiuserurl = "https://script.google.com/macros/s/AKfycbwWFxUmhmfem1mHJT7HDqJoVFNkCmUkInvOOx2K1KZy/dev?access_token="+access_token;
var apidataurl = "https://script.google.com/macros/s/AKfycbxXCV5_Bj1-IqUtezfR_MPLrc-YRGq0pSWVQwPZ5K0/dev?access_token="+access_token;
}
else
{
var apiuserurl = "https://script.google.com/macros/s/AKfycbys-GEdilEu0nqdjDRUlEExkamYVIRsplNMEnLl2WiQQy3DxZoikpts7bnLotnT5IcwzQ/exec";
var apidataurl = "https://script.google.com/macros/s/AKfycbyyPrApY4R8xv-_m8LUz9XHhkdYeTPMovm8MkBXgTXlojx31nHz9GVdGa4Ikw8cELMN/exec";
}

var app = new Framework7({
el: '#app',
theme: 'aurora',
name: 'MyBSMI',
id: 'mybsmi.bsmijatim.org',
view: {
  browserHistory: true,
  browserHistorySeparator: '#page',
},
routes: [
  {
    path: '/',
    url: '/',
    on: {
      pageAfterIn: function test (e, page) {
        //console.log(typeof(dashboarddata));
        if (typeof dashboarddata !== 'undefined'){getdefaultdatarun(dashboarddata);}
      },
    },
  },
  {
    path: '/biodata/',
    url: 'biodata.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpagebiodata();
      },
    },
    beforeEnter: function ({ resolve, reject }) {          
          fperiksauserdata({ resolve, reject })
    },
  },
  {
    path: '/ekta/',
    url: 'ekta.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpageekta();
      },
    },
    beforeEnter: function ({ resolve, reject }) {
        fperiksauserstatus({ resolve, reject })
    },
  },
  {
    path: '/riwayat/',
    url: 'riwayat.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpageriwayat();
      },
    },
    beforeEnter: function ({ resolve, reject }) {
        fperiksauserdata({ resolve, reject })
    },
  },
  {
    path: '/pesan/',
    url: 'pesan.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpagepesan(e, page);        
      },
    },
    beforeEnter: function ({ resolve, reject }) {
      function fperiksakesiapan({ resolve, reject })
      {
          if (typeof dashboarddata === 'undefined' || dashboarddata === null) {
            // variable is undefined or null
            setTimeout(function(){ fperiksakesiapan({ resolve, reject }); }, 1000);
            return;
          }
        resolve();
      }
      fperiksakesiapan({ resolve, reject })
    },
  },
  {
    path: '/bacapesan/:pesanId',
    url: 'bacapesan.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpagebacapesan(page.route.params.pesanId);
        //console.log(page.route.params.pesanId)
      },
    },
    beforeEnter: function ({ resolve, reject }) {
      function fperiksakesiapan({ resolve, reject })
      {
          if (typeof dashboarddata === 'undefined' || dashboarddata === null) {
            // variable is undefined or null
            setTimeout(function(){ fperiksakesiapan({ resolve, reject }); }, 1000);
            return;
          }
        resolve();
      }
      fperiksakesiapan({ resolve, reject })
    },
  },
  {
    path: '/verifikator/',
    url: 'verifikator.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpageverifikator();
      },
    },
    beforeEnter: function ({ resolve, reject }) {
      function fperiksakesiapan({ resolve, reject })
      {
          if (typeof dashboarddata === 'undefined' || dashboarddata === null) {
            // variable is undefined or null
            setTimeout(function(){ fperiksakesiapan({ resolve, reject }); }, 1000);
            return;
          }
            let data = JSON.parse(dashboarddata.user.usermydata)
            if (data.verifikator)
            {
                resolve();
            }
            else
            {
                app.dialog.alert('Tidak punya izin', 'Status')
                reject();
            }
      }
      fperiksakesiapan({ resolve, reject })
    },
  },
  {
    path: '/admin/',
    url: 'admin.html',
    on: {
      pageAfterIn: function test (e, page) {
        fpageadmin();
      },
    },
    beforeEnter: function ({ resolve, reject }) {
      function fperiksakesiapan({ resolve, reject })
      {
          if (typeof dashboarddata === 'undefined' || dashboarddata === null) {
            // variable is undefined or null
            setTimeout(function(){ fperiksakesiapan({ resolve, reject }); }, 1000);
            return;
          }
            let data = JSON.parse(dashboarddata.user.usermydata)
            if (data.admin)
            {
                resolve();
            }
            else
            {
                app.dialog.alert('Tidak punya izin', 'Status')
                reject();
            }
      }
      fperiksakesiapan({ resolve, reject })
    },
  },
  {
    path: '(.*)',
    url: '404.html',
  },
],
});

function fperiksauserdata({ resolve, reject })
{
    if (typeof dashboarddata === 'undefined' || dashboarddata === null) {
      // variable is undefined or null
      setTimeout(function(){ fperiksauserdata({ resolve, reject }); }, 1000);
      return;
    }

      if (dashboarddata.user.userphoto !== '')
      {
        resolve();
      }
      else
      {
        flengkapidata();
        reject();
      }

}

function fperiksauserstatus({ resolve, reject })
{
    if (typeof dashboarddata === 'undefined' || dashboarddata === null) {
      // variable is undefined or null
      setTimeout(function(){ fperiksauserstatus({ resolve, reject }); }, 1000);
      return;
    }
    
       if (dashboarddata.user.userstatus === 'Terverifikasi')
       {
          fperiksauserdata({ resolve, reject })
       }
       else if (dashboarddata.user.userstatus === 'Terbatas')
       {

          if (dashboarddata.user.userphoto !== '')
          {

            let data = JSON.parse(dashboarddata.user.usermydata)
            if (data.verifikasiidentitas)
            {
              app.dialog.alert('Menunggu verifikasi', 'Status')
              reject();
            }
            else
            {
              fverifikasidata();
              reject();
            }

          }
          else
          {
            flengkapidata();
            reject();
          }

       }
       else if (dashboarddata.user.userstatus === 'Tertolak')
       {
          app.dialog.alert('Verifikasi gagal hubungi admin', 'Status')
          reject();
       }
       else
       {
          reject();
       }
}


app.on('pageInit', function (page) {
  //console.log('Page is now pageInit');
  let mypreloader = app.dialog.preloader();
  setTimeout(function () {mypreloader.close();}, 1000);
  
});

app.on('pageAfterIn', function (page) {
  //console.log('Page is pageAfterIn');
  //mypreloader.close();

let myprofile = ''
+'      <div class="right">'
+'        <a class="link popover-open" data-popover=".profile-popover">'
+'          <span class="margin-right-half"></span>'
+'          <img src="avatar.png" class="avatar mybsmi-avatar"><span class="badge color-blue mybsmi-avatar-badge" style="left:-8px;bottom:-5px;display:none;"><i class="icon f7-icons" style="font-size:12px;">checkmark_seal</i></span>'
+'        </a>'
+'      </div>'

  //$$('.navbar-inner .title').append(myprofile);
});

// Fix col sizes
function fixCols() {
setTimeout(function() {
$$('.events-col').css('height', $$('.charts-col').height() + 'px');
});
}
fixCols();
$$(window).on('resize', fixCols);







//aktivasi kalender///////////////////////////
var calendar = app.calendar.create({
inputEl: '.calendar-input',
dateFormat: 'd-m-yyyy',
openIn: 'popover'
});
//aktivasi kalender///////////////////////////





//form-aktivasi/////////////////////////////
$$('.mybsmi-aktivasiscreen').on('click', function () {
  app.dialog.prompt("PIN", "MyBSMI", async function (pin) {
    
    const buf = await crypto.subtle.digest("SHA-256", new TextEncoder("utf-8").encode(pin));
    var pinhash = Array.prototype.map.call(new Uint8Array(buf), x=>(('00'+x.toString(16)).slice(-2))).join('');
    //console.log(pinhash);
    if (pinhash === mybsmiaktivasi)
    {
      app.loginScreen.open('#my-aktivasi-screen');
      window.grecaptchaid = grecaptcha.render( 'mybsmi-grecaptchaaktivasi');
    }
  }
  )
});

$$('#my-aktivasi-screen .register-button').on('click', function () {

  if (!$$('#my-aktivasi-screen')[0].checkValidity()) {
        //console.log('Check Validity!');
        return;
  }
  
  if ((grecaptcharesponsedata == undefined) || (grecaptcharesponsedata == '')){return;}

  var email = $$('#my-aktivasi-screen [name="email"]').val();
  var password = $$('#my-aktivasi-screen [name="password"]').val();
  var konfirmpassword = $$('#my-aktivasi-screen [name="konfirmpassword"]').val();
  var nama = "'"+$$('#my-aktivasi-screen [name="nama"]').val();
  var jeniskelamin = "'"+$$('#my-aktivasi-screen [name="jeniskelamin"]').val();
  var tanggallahir = "'"+$$('#my-aktivasi-screen [name="tanggallahir"]').val();
  var alamatdomisili = "'"+$$('#my-aktivasi-screen [name="alamatdomisili"]').val();
  var profesi = "'"+$$('#my-aktivasi-screen [name="profesi"]').val();
  var golongandarah = "'"+$$('#my-aktivasi-screen [name="golongandarah"]').val();
  var nohp = "'"+$$('#my-aktivasi-screen [name="nohp"]').val();
  var cabang = "'"+$$('#my-aktivasi-screen [name="cabang"]').val();
  var tahun = "'"+$$('#my-aktivasi-screen [name="tahun"]').val();
  
  if(password != konfirmpassword) 
  {
    app.dialog.alert('Password dan Konfirm Password Harus Sama','Terjadi Kesalahan');
    return;
  }
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apiuserurl,
    method: 'POST',
    cache: false,
    data : { command: 'aktivasi', grecaptcharesponsedata: grecaptcharesponsedata, email: email,password: password, nama: nama, jeniskelamin: jeniskelamin, tanggallahir: tanggallahir, alamatdomisili: alamatdomisili, profesi: profesi, golongandarah:golongandarah, nohp: nohp, cabang: cabang, tahun: tahun  }, 
    success: function (data, status, xhr)
      {
        //console.log(data);
        mypreloader.close();

        var status = JSON.parse(data).status;
        var data = JSON.parse(data).data;
        if (status == "success")
        {
          app.loginScreen.close('#my-aktivasi-screen');
          $$('#my-aktivasi-screen')[0].reset();
          //$$('#overlay-welcome').hide();
          app.dialog.alert('Pembuatan akun telah berhasil. Klik halaman login untuk masuk menggunakan email dan password. Hubungi admin jika butuh bantuan. Terima kasih.','Berhasil');
        }
        else if (status == "failed")
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
        else
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  })
  grecaptcha.reset(grecaptchaid);grecaptcharesponsedata = '';
});
//end form aktivasi//////////////////////////







//start form-login/////////////////////////////
$$('#my-login-screen .login-button').on('click', function () {
  if (!$$('#my-login-screen')[0].checkValidity()) {
        //console.log('Check Validity!');
        return;
  }
  
  if ((grecaptcharesponsedata == undefined) || (grecaptcharesponsedata == '')){return;}
  
  var email = $$('#my-login-screen [name="email"]').val();
  var password = $$('#my-login-screen [name="password"]').val();
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apiuserurl,
    method: 'POST',
    cache: false,
    data : { command: 'login',grecaptcharesponsedata: grecaptcharesponsedata, email: email,password: password}, 
    success: function (data, status, xhr)
      {
        //console.log(data);
        mypreloader.close();
                
        var status = JSON.parse(data).status;
        var data = JSON.parse(data).data;
        if (status == "success")
        {
          app.loginScreen.close('#my-login-screen');
          $$('#my-login-screen')[0].reset();
          $$('#overlay-welcome').hide();
          var json = {email:email,token:data.token};
          window.mybsmiuseremail = email;
          window.mybsmiusertoken = data.token;
          window.localStorage["mybsmiuser"] = JSON.stringify(json);
          window.dashboarddata = data;
          getdefaultdatarun(data);
        }
        else if (status == "failed")
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
          $$('#my-login-screen')[0].reset();
        }
        else if (status == "verifikasiemail")
        {
          //app.dialog.alert(data,'Terjadi Kesalahan');
            $$('#my-login-screen')[0].reset();
            var dialog = app.dialog.create({
              text: 'Akun membutuhkan verifikasi email',
              closeByBackdropClick: true,
              on: {
                opened: function () {
                  console.log('Dialog opened')
                }
              },
              buttons: [
                {
                  text: 'Kirim Email',
                  close:false,
                  onClick: function(dialog, e)
                    {
                        let mypreloader = app.dialog.preloader();
                        app.request({
                          url: apiuserurl,
                          method: 'POST',
                          cache: false,
                          data : { command: 'verifikasiemail', email: email,password: password  }, 
                          success: function (data, status, xhr)
                            {
                              //console.log(data);
                              mypreloader.close();

                              var status = JSON.parse(data).status;
                              var data = JSON.parse(data).data;
                              if (status == "success")
                              {
                                dialog.close();
                                app.dialog.alert('Mohon periksa kotak masuk atau kotak spam email anda','Email terkirim');
                              }
                              else if (status == "failed")
                              {
                                app.dialog.alert(data,'Terjadi Kesalahan');
                              }
                              else if (status == "dayliquotalimit")
                              {
                                app.dialog.alert('Saat ini server mencapai limit pengiriman email harian mohon coba lagi besok.','Terjadi Masalah');
                              }
                              else
                              {
                                app.dialog.alert('Tidak dapat memproses data','Terjadi Kesalahan');
                              }
                            },
                          error: function (xhr, status, message)
                            {
                              //console.log(message);
                              mypreloader.close();
                              app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
                            },
                        })
                    }
                }
              ],
            })
            dialog.open();          
        }
        else if (status == "verifikasidata")
        {
          app.dialog.alert('Akun masih dalam proses verifikasi data','Proses Verifikasi');
          $$('#my-login-screen')[0].reset();
        }
        else if (status == "suspen")
        {
          app.dialog.alert(data,'Pemberitahuan');///////////////////////////////////////////////////////////////////////////////////////
          $$('#my-login-screen')[0].reset();
        }
        else
        {
          app.dialog.alert('Tidak dapat memproses data','Terjadi Kesalahan');
          $$('#my-login-screen')[0].reset();
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        app.dialog.alert('Server sedang sibuk','Terjadi Kesalahan');
      },
  })
  grecaptcha.reset();grecaptcharesponsedata = '';
});
document.getElementById('my-login-screen').onkeydown = function(e){
   if(e.keyCode == 13){
     $$('#my-login-screen .login-button').click();
   }
};
//end form-login/////////////////////////////







/////////////verifikasiemail//////////////////

var code = params.verifikasi;//console.log(code);

if (code !== undefined)
{
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apiuserurl,
    method: 'GET',
    cache: false,
    data : { command: 'verifikasiemail', code: code}, 
    success: function (data, status, xhr)
      {
        //console.log(data);
        mypreloader.close();

        var status = JSON.parse(data).status;
        var data = JSON.parse(data).data;
        if (status == "success")
        {
            var dialog = app.dialog.create({
              text: 'Alamat email berhasil diverifikasi',
              on: {
                opened: function () {
                  //console.log('Dialog opened')
                }
              },
              buttons: [
                {
                  text: 'OK',
                  close:false,
                  onClick: function(dialog, e)
                    {
                      window.location.href = 'https://mybsmi.bsmijatim.org';
                    }
                }
              ]
            })
            dialog.open();
        }
        else if (status == "failed")
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
        else
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  })
}

//endverifikasiemail/////////////////////////





////pencarian///////////////////////////////////////////////
//var params = getParams(window.location.href);
var cari = params.cari;
if (cari !== undefined)
{
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'GET',
    cache: false,
    data : { command: 'pencarian', cari: cari}, 
    success: function (data, status, xhr)
      {
        //console.log(data);
        mypreloader.close();

        var status = JSON.parse(data).status;
        var data = JSON.parse(data).data;
        if (status == "success")
        {
            //console.log(data);
            var dialog = app.dialog.create({
              title: 'Data ditemukan',
              content: '<p>Nama : '+safe(data.nama)+'</p><p>Cabang : '+safe(data.cabang)+'</p>',
              on: {
                opened: function () {
                  //console.log('Dialog opened')
                }
              },
              buttons: [
                {
                  text: 'OK',
                  close:true,
                  onClick: function(dialog, e)
                    {
                      window.location.href = 'https://mybsmi.bsmijatim.org';
                    }
                }
              ]
            })
            dialog.open();
        }
        else if (status == "failed")
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
        else
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  })
}
////pencarian//////////////////////////////////////////////




//////dev mode/////////////////////////////////////////////////////////
if (isLocal)
{
  app.dialog.prompt('', 'DEV MODE', function (pwd){fdevmode(pwd);})
}

function fdevmode(pwd)
{
  let mypreloader = app.dialog.preloader();
  let devmodeurl = 'https://script.google.com/macros/s/AKfycbztYLCDVY-nZyQJFK7QhIRboEcuRUWPIrfkGzbU6bUnTEn909HgWhwc1VadGotPDIkp7Q/exec';
  app.request({
    url: devmodeurl,
    method: 'POST',
    cache: false,
    data : { password: pwd}, 
    success: function (data, status, xhr)
      {
        //console.log(data);
        mypreloader.close();

        var status = JSON.parse(data).status;
        var data = JSON.parse(data).data;
        if (status == "success")
        {
            //console.log(data);
            window.location.href = '/?access_token='+data;
        }
        else if (status == "failed")
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
        else
        {
          app.dialog.alert(data,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  })
}
///////dev mode/////////////////////////////////////////////////////////





//start check session/////////////////////////
if (localStorage.getItem("mybsmiuser") !== null) {
  var json = window.localStorage["mybsmiuser"];
  var email = JSON.parse(json).email;
  var token = JSON.parse(json).token
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apiuserurl,
    method: 'POST',
    cache: false,
    data : { command: 'loginwithtoken', email: email, password: token}, 
    success: function (data, status, xhr)
      {
        //console.log(data);
        mypreloader.close();
                
        var status = JSON.parse(data).status;
        var data = JSON.parse(data).data;
        if (status == "success")
        {
          //console.log(data);
          $$('#overlay-welcome').hide();
          window.mybsmiuseremail = email;
          window.mybsmiusertoken = token;
          window.dashboarddata = data;
          getdefaultdatarun(data);
        }
        else if (status == "failed")
        {
          localStorage.removeItem("mybsmiuser");
        }
        else
        {
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
      },
  })
} 
//end check session///////////////////////////






///logout button/////////////////////////
function flogout()
{
$$('.my-logout').on('click', function () {
  localStorage.removeItem("mybsmiuser");
  window.mybsmiuseremail = '';
  window.mybsmiusertoken = '';
  app.popover.close('.profile-popover', false);
  $$('#overlay-welcome').css('display','flex');
  //let mypreloader = app.dialog.preloader();
  window.location.href = 'https://bsmijatim.org'
});
}
///logout button/////////////////////////






////start getdefaultdata///////////////////////////
function getdefaultdata(render=true)
{
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'getdefaultdata'}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          //console.log(content);
          if (render){getdefaultdatarun(content)}
          window.dashboarddata = content;
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        console.log(message);
        mypreloader.close();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  })
}

function getdefaultdatarun(data)
{
  $$('.mybsmi-currentusernama').text(safe(data.user.usernama));
  if (data.user.userphoto !== '') {$$('.mybsmi-avatar').attr('src','https://drive.google.com/uc?export=view&id='+safe(data.user.userphoto));}
  if (data.user.userstatus === "Terverifikasi"){$$('.mybsmi-avatar-badge').css('display','flex');};
  flogout();
  
  var relawan = -1;
  var cabang = 0;
  var rekapitulasiprov = '';
  var rekapitulasicabang = '';
  var datacabang = data.cabang;
  datacabang.sort(function(a, b){return b.relawan - a.relawan});
  for(i=0;i<datacabang.length;i++)
  {
    if (datacabang[i].cabang == 'BSMI Jawa Timur')
    {
      rekapitulasiprov += '<tr> <td class="label-cell">'+safe(datacabang[i].cabang)+'</td> <td class="numeric-cell">'+safe(datacabang[i].relawan-1)+'</td> </tr>';
    }
    else
    {
    rekapitulasicabang += '<tr> <td class="label-cell">'+safe(datacabang[i].cabang)+'</td> <td class="numeric-cell">'+safe(datacabang[i].relawan)+'</td> </tr>';
    cabang = cabang+1;
    }
    relawan = relawan+datacabang[i].relawan;
  }
  $$('.mybsmi-rekapitulasicabang').html(rekapitulasicabang);
  $$('.mybsmi-rekapitulasiprov').html(rekapitulasiprov);
  
  var ratiorelawan = relawan/(relawan*10);
  var gauge = app.gauge.get('#mybsmi-relawan');
  gauge.update({
    el: '#mybsmi-relawan',
    value: ratiorelawan,
    valueText: relawan,
  })  

  var ratiocabang = cabang/38;
  var gauge = app.gauge.get('#mybsmi-cabang');
  gauge.update({
    el: '#mybsmi-cabang',
    value: ratiocabang,
    valueText: cabang,
  })
  
  let ver = JSON.parse(data.user.usermydata)
  if (ver.verifikator)
  {
    $$('.mybsmi-verifikatormenu').show();
  }  
  if (ver.admin)
  {
    $$('.mybsmi-adminmenu').show();
  }  
  
}
///end getdefaultdata//////////////////////////////





///grecaptcha/////////////////////////////////
function grecaptcharesponse(data)
{
  //console.log(data);
  grecaptcharesponsedata = data;
}

function grecaptchaexpired()
{
  //console.log('expired');
  grecaptcharesponsedata = '';
}
///grecaptcha/////////////////////////////////




////fpagebiodata////////////////////////////
function fpagebiodata()
{
    var data = dashboarddata.user;
    $$('.mybsmi-biodata .mybsmi-userphoto').attr('src','https://drive.google.com/uc?export=view&id='+safe(data.userphoto));
    $$('.mybsmi-biodata .mybsmi-usernama').text(safe(data.usernama));
    $$('.mybsmi-biodata .mybsmi-userjeniskelamin').text(safe(data.userjeniskelamin));
    $$('.mybsmi-biodata .mybsmi-usertanggallahir').text(safe(data.usertanggallahir));
    $$('.mybsmi-biodata .mybsmi-userprofesi').text(safe(data.userprofesi));
    $$('.mybsmi-biodata .mybsmi-usergolongandarah').text(safe(data.usergolongandarah));
    $$('.mybsmi-biodata .mybsmi-useralamatdomisili').text(safe(data.useralamatdomisili));
    $$('.mybsmi-biodata .mybsmi-useremail').text(safe(data.useremail));
    $$('.mybsmi-biodata .mybsmi-usernohp').text(safe(data.userhp));
    $$('.mybsmi-biodata .mybsmi-usercabang').text(safe(data.usercabang));
    $$('.mybsmi-biodata .mybsmi-usertahunbergabung').text(safe(data.usertahunbergabung));
    if (data.userstatus === "Terverifikasi"){$$('.mybsmi-avatar-badge').css('display','flex');};
}
////fpagebiodata////////////////////////////




///////RESET PASSWORD BUTTON/////////////////////////////////////////////////////////////////////////////////////////////////
function resetpasswordbutton()
{
    $$(".reset-password-open").click(function(){
      resetpasswordopen();
    });
}

resetpasswordbutton();

function resetpasswordopen()
{
    var dynamicPopup = app.popup.create({
      content: '<div class="popup" style="background:#fff">'+
      '<div class="block">'+
      
        '<form id="resetpasswordform" class="login-screen-content"><div class="login-screen-title">Reset Password</div> <div class="list"> <ul> <li class="item-content item-input"> <div class="item-inner"> <div class="item-title item-label">Email</div> <div class="item-input-wrap"> <input id="resetpasswordemail" type="email" name="email" placeholder="Masukkan email" required validate> </div> </div> </li> <li class="item-content item-input"> <div style="padding:20px 20px;justify-content:center;align-items:center;display:flex;width:100%;"> <div id="mybsmi-lupapassword" class="g-recaptcha" data-sitekey="6LcP1RskAAAAANtjMoK9vf0tL37hI_uRIxsQm9-k" data-callback="grecaptcharesponse" data-expired-callback="grecaptchaexpired"></div> </div> <li> </ul> </div> <div class="list"> <div class="block-footer"><a href="#" class="button button-raised button-fill resetpasswordemailsubmit">SUBMIT</a><center><a href="#" class="item-link list-button actions-close popup-close">Batal</a></center></div> </div></form>'+
        
       '</div></div>',
    });     
    dynamicPopup.open();
    grecaptcha.render( 'mybsmi-lupapassword');
        
    $$(".resetpasswordemailsubmit").click(function(){
      resetpasswordemail(dynamicPopup);
    });  
}

function resetpasswordemail(dynamicPopup)
{
    if (!$$('#resetpasswordform')[0].checkValidity()) {
        //console.log('Check Validity!');
        return;
    }
    
    if ((grecaptcharesponsedata == undefined) || (grecaptcharesponsedata == '')){return;}
    
    var email = $$('#resetpasswordform [name="email"]').val();
    //console.log(email);
      
      let mypreloader = app.dialog.preloader(); 
      app.request({
          method: "POST",
          data : {command:'resetpasswordemail',email: email, password: 'pwd',grecaptcharesponsedata: grecaptcharesponsedata},
          url: apiuserurl,
          error: function(xhr, status, message) 
            {
              //console.log(message);
              mypreloader.close();
              dynamicPopup.close();  
              var toastBottom = app.toast.create({ text: 'Server sedang sibuk', closeTimeout: 5000,position: 'center', });toastBottom.open();          
            },
          success: function(data, status, xhr) 
            {
              //console.log(data);
              mypreloader.close(); 
              //var toastBottom = app.toast.create({ text: jqXHR.responseText, closeTimeout: 2000,position: 'center', });toastBottom.open();
              var json = JSON.parse(data); 
              var status = json['status'];
              var msg = json['data'];
              if (status === "success")
              {
                dynamicPopup.close();
                resetpasswordotpform(email,msg);
              }
              else if ((status === "error") || (status === "failed")) 
              {
                dynamicPopup.close();
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
              else
              {
                dynamicPopup.close();
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
              
            }
      }); 
      
}
function resetpasswordotpform(email,hash)
{
    var dynamicPopup = app.popup.create({
      content: '<div class="popup" style="background:#fff">'+
      '<div class="block">'+
      
        '<form id="resetpasswordotpform" class="login-screen-content"><div class="login-screen-title">Reset Password</div><center><p>Kode OTP telah dikirimkan ke email anda. Periksa di inbox atau folder spam. </p><p>Kedaluwarsa dalam <span id="otpexpired">120</span> detik</p></center> <div class="list"> <ul> <li class="item-content item-input"> <div class="item-inner"> <div class="item-title item-label">Kode OTP</div> <div class="item-input-wrap"> <input id="resetpasswordotp" type="text" name="otp" placeholder="Masukkan kode OTP" pattern="[0-9]{6}" required validate> </div> </div> </li> <li class="item-content item-input"> <div style="padding:20px 20px;justify-content:center;align-items:center;display:flex;width:100%;"> <div id="mybsmi-lupapasswordotp" class="g-recaptcha" data-sitekey="6LcP1RskAAAAANtjMoK9vf0tL37hI_uRIxsQm9-k" data-callback="grecaptcharesponse" data-expired-callback="grecaptchaexpired"></div> </div> <li></ul> </div> <div class="list"> <div class="block-footer"><a href="#" class="button button-raised button-fill resetpasswordotpsubmit">SUBMIT</a><center><a href="#" class="item-link list-button actions-close popup-close">Batal</a></center></div> </div></form>'+
        
       '</div></div>',
    });     
    dynamicPopup.open();
    grecaptcha.render( 'mybsmi-lupapasswordotp');
    
    otpexpired();
    
    $$(".resetpasswordotpsubmit").click(function(){
      resetpasswordotp(dynamicPopup,email,hash);
    }); 
}

function otpexpired()
{
    setTimeout(function () {
          var expired = $$('#otpexpired').text();
          if (expired != 0)
          {
            var newexpired = expired-1;
            $$('#otpexpired').text(newexpired);
            otpexpired();
          }
    }, 1000);
}

function resetpasswordotp(dynamicPopup,email,hash)
{
    if (!$$('#resetpasswordotpform')[0].checkValidity()) {
        //console.log('Check Validity!');
        return;
    }
    
    if ((grecaptcharesponsedata == undefined) || (grecaptcharesponsedata == '')){return;}
    
    var otp = $$('#resetpasswordotpform [name="otp"]').val();
    //console.log(email);
      
      let mypreloader = app.dialog.preloader(); 
      app.request({
          method: "POST",
          data : {command:'resetpasswordotp',email:email,password:'pwd',hash:hash,otp:otp,grecaptcharesponsedata: grecaptcharesponsedata},
          url: apiuserurl,
          error: function(xhr, status, message) 
            {
              //console.log(message);
              mypreloader.close(); 
              dynamicPopup.close(); 
              var toastBottom = app.toast.create({ text: 'Server sedang sibuk', closeTimeout: 5000,position: 'center', });toastBottom.open();          
            },
          success: function(data, status, xhr) 
            {
              //console.log(data);
              mypreloader.close(); 
              dynamicPopup.close();
              var json = JSON.parse(data); 
              var status = json['status'];
              var msg = json['data'];
              if (status === "success")
              {
              resetpasswordinputform(msg,email);
              }
              else if (status === "failed")
              {
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
              else
              {
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
            }
      }); 
}

function resetpasswordinputform(data,email)
{
    var dynamicPopup = app.popup.create({
      content: '<div class="popup" style="background:#fff">'+
      '<div class="block">'+
      
        '<form id="resetpasswordinputform" class="login-screen-content"><div class="login-screen-title">Reset Password</div><p><center>Masukkan password baru anda. </center></p> <div class="list"> <ul> <li class="item-content item-input"> <div class="item-inner"> <div class="item-title item-label">Password</div> <div class="item-input-wrap"> <input id="resetpasswordinput" type="password" name="password" placeholder="Masukkan password baru" minlength="10" required validate> </div> </div> </li> </ul> </div> <div class="list"> <div class="block-footer"><a href="#" class="button button-raised button-fill resetpasswordinputsubmit">SUBMIT</a><center><a href="#" class="item-link list-button actions-close popup-close">Batal</a></center></div> </div></form>'+
        
       '</div></div>',
    });     
    dynamicPopup.open();
    
    $$(".resetpasswordinputsubmit").click(function(){
      resetpasswordinput(dynamicPopup,data,email);
    }); 
}

function resetpasswordinput(dynamicPopup,data,email)
{
    if (!$$('#resetpasswordinputform')[0].checkValidity()) {
        //console.log('Check Validity!');
        return;
    }
    var password = $$('#resetpasswordinputform [name="password"]').val();
    //console.log(email);
      
      let mypreloader = app.dialog.preloader(); 
      app.request({
          method: "POST",
          data : {command:'resetpasswordinput',email:email,key:data,password:password},
          url: apiuserurl,
          error: function(xhr, status, message) 
            {
              //console.log(message);
              mypreloader.close();  
              dynamicPopup.close();
              var toastBottom = app.toast.create({ text: 'Server sedang sibuk', closeTimeout: 5000,position: 'center', });toastBottom.open();          
            },
          success: function(data, status, xhr) 
            {
              //console.log(data);
              mypreloader.close(); 
              dynamicPopup.close();
              var json = JSON.parse(data); 
              var status = json['status'];
              var msg = json['data'];
              if (status === "success")
              {
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
              else if (status === "failed")
              {
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
              else
              {
                var toastBottom = app.toast.create({ text: msg, closeTimeout: 5000,position: 'center', });toastBottom.open();
              }
            }
      }); 
}
///////RESET PASSWORD BUTTON/////////////////////////////////////////////////////////////////////////////////////////////////




///////lengkapi data/////////////////////////////////////
function flengkapidata()
{
  var dialog = app.dialog.create({
    text: 'Silahkan lengkapi data Anda untuk membuka fitur ini.',
    closeByBackdropClick: false,
    destroyOnClose: true,
    on: {
      opened: function () {
        //console.log('Dialog opened')
      }
    },
    buttons: [
      {
        text: 'Nanti Saja',
        close:true,
        color: 'gray',
        onClick: function(dialog, e)
          {
          }
      },
      {
        text: 'Lengkapi Data',
        close:true,
        onClick: function(dialog, e)
          {
            flengkapiphoto();
          }
      },
    ]
  });
  dialog.open();
}

function flengkapiphoto()
{
  var dialog = app.dialog.create({
    title: 'Photo',
    closeByBackdropClick: false,
    destroyOnClose: true,
    content: '<div style="width:100%;">'
      +'<form runat="server" style="display:flex;flex-direction:column;align-items:center;justify-content: center;">'
      +'<img id="mybsmiuploadphotopreview" src="avatar.png" style="width:150px;height:150px;margin: 10px 10px;border-radius: 50%;object-fit: cover;">'
      +'<input accept="image/jpeg" type="file" id="mybsmiuploadphoto" />'
      +'</form>'
      +'</div>',
    on: {
      opened: function () {
          mybsmiuploadphoto.onchange = evt => {
            const [file] = mybsmiuploadphoto.files
            if (file) {
              if (file.size > 524288)
              {
                //app.dialog.alert('File tidak boleh lebih dari 500 KB','Terjadi Kesalahan');
                var toastBottom = app.toast.create({ text: 'File tidak boleh lebih dari 500 KB', closeTimeout: 5000,position: 'center', });toastBottom.open();
                mybsmiuploadphoto.value = '';
                mybsmiuploadphotopreview.src = 'avatar.png'
              }
              else
              {
                mybsmiuploadphotopreview.src = URL.createObjectURL(file)
              }
            }
            else
            {
              mybsmiuploadphotopreview.src = 'avatar.png'
            }
          }
      }
    },
    buttons: [
      {
        text: 'Cancel',
        close:true,
        color: 'gray',
        onClick: function(dialog, e)
          {
          }
      },
      {
        text: 'Upload',
        close:false,
        onClick: function(dialog, e)
          {
            const [file] = mybsmiuploadphoto.files
            if (file) {
              const fr = new FileReader();
              fr.onload = function(e) {
                const obj = {
                  filename: file.name,
                  mimeType: file.type,
                  bytes: [...new Int8Array(e.target.result)]
                };
                fuploadphoto(dialog,obj);
              };
              fr.readAsArrayBuffer(file);
            }
          }
      },
    ]
  });
  dialog.open();


}

function fuploadphoto(dialog,obj)
{
  //console.log(obj);
  var data = JSON.stringify(obj);
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'uploaduserphoto', data: data}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        dialog.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          //console.log(content);
          getdefaultdata();
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        dialog.close();dialog.destroy();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  });
}
//////lengkapi data/////////////////////////////////////////////////



///////verifikasi data///////////////////////////////////////////////
function fverifikasidata()
{
  var dialog = app.dialog.create({
    title: 'Permintaan Verifikasi',
    text: 'Silahkan verifikasi identitas Anda untuk membuka fitur ini.',
    closeByBackdropClick: false,
    destroyOnClose: true,
    on: {
      opened: function () {
        //console.log('Dialog opened')
      }
    },
    buttons: [
      {
        text: 'Nanti Saja',
        close:true,
        color: 'gray',
        onClick: function(dialog, e)
          {
          }
      },
      {
        text: 'Verifikasi',
        close:true,
        onClick: function(dialog, e)
          {
            fverifikasiidentitas();
          }
      },
    ]
  });
  dialog.open();
}

function fverifikasiidentitas()
{
  var dialog = app.dialog.create({
    title: 'Permintaan Verifikasi',
    closeByBackdropClick: false,
    destroyOnClose: true,
    content: '<div style="width:100%;height:60vh;overflow:auto;">'
      +'<form id="mybsmi-formverifikasiidentitas" runat="server" style="display:flex;flex-direction:column;align-items:center;justify-content: center;">'
      +'  <img id="mybsmiuploadphotopreview" src="ktpplaceholder.png" style="width:200px;height:150px;margin: 10px 10px;object-fit: contain;">'
      +'  <input accept="image/jpeg" type="file" name="mybsmiuploadphoto" id="mybsmiuploadphoto" required validate/>'
      +'  <div class="list no-hairlines-md">'
      +'    <ul>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            Isi Sesuai Identitas'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="nik" placeholder="NIK" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="nama" placeholder="Nama" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="ttl" placeholder="Tempat/Tgl Lahir" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="jeniskelamin" placeholder="Jenis Kelamin" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="alamat" placeholder="Alamat" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="rtrw" placeholder="RT/RW" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="keldesa" placeholder="Kel/Desa" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="kecamatan" placeholder="Kecamatan" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="kabupaten" placeholder="Kabupaten" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="provinsi" placeholder="Provinsi" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="agama" placeholder="Agama" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="statusperkawinan" placeholder="Status Perkawinan" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="pekerjaan" placeholder="Pekerjaan" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="kewarganegaraan" placeholder="Kewarganegaraan" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'        <li class="item-content item-input"><div class="item-inner"><div class="item-input-wrap">'
      +'            <input type="text" name="berlakuhingga" placeholder="Berlaku Hingga" required validate/>'
      +'            </div></div>'
      +'        </li>'
      +'    </ul>'
      +'  </div>'
      +'</form>'
      +'</div>',
    on: {
      opened: function () {
          mybsmiuploadphoto.onchange = evt => {
            const [file] = mybsmiuploadphoto.files
            if (file) {
              if (file.size > 524288)
              {
                //app.dialog.alert('File tidak boleh lebih dari 500 KB','Terjadi Kesalahan');
                var toastBottom = app.toast.create({ text: 'File tidak boleh lebih dari 500 KB', closeTimeout: 5000,position: 'center', });toastBottom.open();
                mybsmiuploadphoto.value = '';
                mybsmiuploadphotopreview.src = 'ktpplaceholder.png'
              }
              else
              {
                mybsmiuploadphotopreview.src = URL.createObjectURL(file)
              }
            }
            else
            {
              mybsmiuploadphotopreview.src = 'ktpplaceholder.png'
            }
          }
      }
    },
    buttons: [
      {
        text: 'Cancel',
        close:true,
        color: 'gray',
        onClick: function(dialog, e)
          {
          }
      },
      {
        text: 'Verifikasi',
        close:false,
        onClick: function(dialog, e)
          {            
            const [file] = mybsmiuploadphoto.files
            if (file) {
              if (!$$('#mybsmi-formverifikasiidentitas')[0].checkValidity()) {
                    //console.log('Check Validity!');
                    return;
              }
              var dataform = JSON.stringify(app.form.convertToData('#mybsmi-formverifikasiidentitas'));//console.log(dataform);
              const fr = new FileReader();
              fr.onload = function(e) {
                const obj = {
                  filename: file.name,
                  mimeType: file.type,
                  bytes: [...new Int8Array(e.target.result)],
                  ktp: dataform
                };
                fkirimverifikasiidentitas(dialog,obj);
              };
              fr.readAsArrayBuffer(file);
            }
            else
            {
              var toastBottom = app.toast.create({ text: 'Pilih file KTP', closeTimeout: 5000,position: 'center', });toastBottom.open();
            }
          }
      },
    ]
  });
  dialog.open();
}

function fkirimverifikasiidentitas(dialog,obj)
{
  //console.log(obj);
  var data = JSON.stringify(obj);
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'verifikasiidentitas', data: data}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        dialog.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          //console.log(content);
          app.dialog.alert("Permintaan verifikasi telah terkirim. Proses verifikasi bisa membutuhkan beberapa hari. Terima kasih.",'Permintaan Verifikasi');
          getdefaultdata();
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        mypreloader.close();
        dialog.close();dialog.destroy();
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
      },
  });
}
///////verifikasi data///////////////////////////////////////////////





//////fpageekta///////////////////////////////////////////////////
function fpageekta()
{
    let data = JSON.parse(dashboarddata.user.usermydata)
    if (data.ekta)
    {
        fgetekta();
    }
    else
    {
      $$('.mybsmi-ektabsmi').html('<a class="button button-fill">BUAT e-KTA</a>');
      $$('.mybsmi-ektabsmi a').on('click', function () {
            
            app.dialog.confirm('Pembuatan e-KTA memerlukan waktu 2-4 menit.', 'Pemberitahuan', function (){fbuatekta();})
      });
    }
}

function fbuatekta()
{
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'buatekta'}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          //console.log(content);
          convertekta();
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
        mypreloader.close();
      },
  })
}

function convertekta()
{
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'convertekta'}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          //console.log(content);
          fgetekta();
          getdefaultdata(false);
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
        mypreloader.close();
      },
  })
}

function fgetekta()
{

  if (typeof mybsmiekta === 'undefined' || mybsmiekta === null)
  {
      let mypreloader = app.dialog.preloader();
      app.request({
        url: apidataurl,
        method: 'POST',
        cache: false,
        data : { token:mybsmiusertoken, command: 'getekta'}, 
        success: function (data, status, xhr)
          {
            mypreloader.close();
            var status = JSON.parse(data).status;
            var content = JSON.parse(data).data;
            if (status == "success")
            {
              //console.log(content);
              window.mybsmiekta = content;
              $$('.mybsmi-ektabsmi').html('<img id="imgekta" src="" style="width:100%;max-width:200px;cursor:pointer;" onclick="javascript:myimage(this)">');
              let src = "https://drive.google.com/uc?export=view&id="+safe(content);
              $$('#imgekta').attr('src',src);
            }
            else if (status == "failed")
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
            else
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
          },
        error: function (xhr, status, message)
          {
            //console.log(message);
            app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
            mypreloader.close();
          },
      })
  }
  else
  {
        $$('.mybsmi-ektabsmi').html('<img id="imgekta" src="" style="width:100%;max-width:200px;cursor:pointer;" onclick="javascript:myimage(this)">');
        let src = "https://drive.google.com/uc?export=view&id="+safe(mybsmiekta);
        $$('#imgekta').attr('src',src);
  }
}
//////fpageekta///////////////////////////////////////////////////



/////fpageriwayat////////////////////////////////////////////
function fpageriwayat()
{
  if (typeof mybsmiriwayat === 'undefined' || mybsmiriwayat === null)
  {
      let mypreloader = app.dialog.preloader();
      app.request({
        url: apidataurl,
        method: 'POST',
        cache: false,
        data : { token:mybsmiusertoken, command: 'getriwayatdata'}, 
        success: function (data, status, xhr)
          {
            mypreloader.close();
            var status = JSON.parse(data).status;
            var content = JSON.parse(data).data;
            if (status == "success")
            {
              //console.log(content);
              window.mybsmiriwayat = content;
              getriwayatdatarun(content)
            }
            else if (status == "failed")
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
            else
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
          },
        error: function (xhr, status, message)
          {
            //console.log(message);
            mypreloader.close();
            app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
          },
      })
  }
  else
  {
    getriwayatdatarun(mybsmiriwayat)
  }
}

function getriwayatdatarun(content)
{
  let data = '';
  for(i=content.length-1;i>-1;i--)
  {
    //let date = new Date(content[i][0]).toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });
    let date = new Intl.DateTimeFormat("id-ID", { hour12:false,dateStyle: "long" , timeStyle: "short",  timeZone: "Asia/Jakarta"}).format(new Date(content[i][0]));
    data += '<div class="timeline-item"><div class="timeline-item-date"><small>'+date+'</small></div><div class="timeline-item-divider"></div><div class="timeline-item-content"><div class="timeline-item-inner"><div class="timeline-item-time"></div><div class="timeline-item-text">'+safe(content[i][5])+'</div></div></div></div>';
  }
  $$('.mybsmi-riwayat').html(data);
}
/////fpageriwayat////////////////////////////////////////////


//////////fpageverifikator////////////////////////////////////////////
function fpageverifikator()
{
  if (typeof mybsmiverifikatordata === 'undefined' || mybsmiverifikatordata === null)
  {
      let mypreloader = app.dialog.preloader();
      app.request({
        url: apidataurl,
        method: 'POST',
        cache: false,
        data : { token:mybsmiusertoken, command: 'getverifikatordata'}, 
        success: function (data, status, xhr)
          {
            mypreloader.close();
            var status = JSON.parse(data).status;
            var content = JSON.parse(data).data;
            if (status == "success")
            {
              window.mybsmiverifikatordata = content;
              fpageverifikatorrun(content);
            }
            else if (status == "failed")
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
            else
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
          },
        error: function (xhr, status, message)
          {
            //console.log(message);
            mypreloader.close();
            app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
          },
      })
  }
  else
  {
    fpageverifikatorrun(mybsmiverifikatordata);
  }

  $$('.mybsmi-verifikatorrefresh').on('click', function () {
    mybsmiverifikatordata = null
    fpageverifikator()
  })
}

function fpageverifikatorrun(content)
{
  var data = '<div class="data-table data-table-collapsible data-table-init"><table><thead><tr><th>Nama</th><th>Email</th><th>Cabang</th><th></th></tr></thead><tbody>';
  for (i=0;i<content.length;i++)
  {
      if ((content[i][2] === 'nuzulz+1@gmail.com')&&(mybsmiuseremail !== 'nuzulz@gmail.com')){continue;}else{if ((content[i][2] === 'nuzulz+1@gmail.com')&&(!isLocal)){continue;}else{
      
        data += '<a href="'+safe(content[i][4])+'" title="'+safe(content[i][4])+'">testing '+safe(content[i][4])+'</a>';
        
      }}
      
      data += '<tr class="mybsmi-verifikator-item-'+safe(content[i][1])+'"><td data-collapsible-title="Nama">'+safe(content[i][4])+'</td><td data-collapsible-title="Email">'+safe(content[i][2])+'</td><td data-collapsible-title="Cabang">'+safe(content[i][11])+'</td><td><a class="button button-fill mybsmi-verifikatoraction" data-user="'+btoa(JSON.stringify(content[i]))+'">Periksa</a></td></tr>';
  }
  data += '</tbody></table></div>';
  $$('.mybsmi-verifikator').html(data);

  $$('.mybsmi-verifikator a.mybsmi-verifikatoraction').on('click', function (e) {
        
        //app.dialog.confirm('Pembuatan e-KTA memerlukan waktu 2-4 menit.', 'Pemberitahuan', function (){fbuatekta();})
        var base64 = this.attributes["data-user"].value;
        fpageverifikatoridentitas(base64)
  });
}

function fpageverifikatoridentitas(base64)
{
  var data = atob(base64);data = JSON.parse(data);
  var uid = data[1];
  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'getverifikatoridentitasdata', uid:uid}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          
          fpageverifikatoridentitasrun(base64,content);
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
        mypreloader.close();
      },
  })
}

function fpageverifikatoridentitasrun(base64,content)
{
  var data = atob(base64);data = JSON.parse(data);
  var dialog = app.dialog.create({
    title: 'Verifikasi Akun Relawan',
    content:''////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      +'<div style="width:100%;height:50vh;overflow:auto;">'
      +'  <div style="display:flex;flex-direction:column;align-items:center;justify-content: center;">'
      +'      <img id="img" src="" style="width:150px;height:150px;margin: 10px 10px;border-radius: 50%;object-fit: cover;">'
      +'      <p style="font-weight:bold;">Data Akun</p>'
      +'      <div class="data-table"><table><tbody>'
      +'          <tr><td>Nama</td><td>'+safe(data[4])+'</td></tr>'
      +'          <tr><td>Email</td><td>'+safe(data[2])+'</td></tr>'
      +'          <tr><td>Cabang</td><td>'+safe(data[11])+'</td></tr>'
      +'          <tr><td>Jenis Kelamin</td><td>'+safe(data[5])+'</td></tr>'
      +'          <tr><td>Alamat</td><td>'+safe(data[7])+'</td></tr>'
      +'          <tr><td>Profesi</td><td>'+safe(data[8])+'</td></tr>'
      +'          <tr><td>Golongan Darah</td><td>'+safe(data[9])+'</td></tr>'
      +'          <tr><td>No HP</td><td>'+safe(data[10])+'</td></tr>'
      +'          <tr><td>Tahun Bergabung</td><td>'+safe(data[12])+'</td></tr>'
      +'      </tbody></table></div>'

      +'      <p style="font-weight:bold;">Data Sesuai Identitas</p>'
      +'      <div class="data-table"><table><tbody>'
      +'          <tr><td>NIK</td><td>'+safe(content[0][4])+'</td></tr>'
      +'          <tr><td>Nama</td><td>'+safe(content[0][5])+'</td></tr>'
      +'          <tr><td>TTL</td><td>'+safe(content[0][6])+'</td></tr>'
      +'          <tr><td>Jenis Kelamin</td><td>'+safe(content[0][7])+'</td></tr>'
      +'          <tr><td>Alamat</td><td>'+safe(content[0][8])+'</td></tr>'
      +'          <tr><td>RT/RW</td><td>'+safe(content[0][9])+'</td></tr>'
      +'          <tr><td>Desa/Kelurahan</td><td>'+safe(content[0][10])+'</td></tr>'
      +'          <tr><td>Kecamatan</td><td>'+safe(content[0][11])+'</td></tr>'
      +'          <tr><td>Kabupaten</td><td>'+safe(content[0][12])+'</td></tr>'
      +'          <tr><td>Provinsi</td><td>'+safe(content[0][13])+'</td></tr>'
      +'          <tr><td>Agama</td><td>'+safe(content[0][14])+'</td></tr>'
      +'          <tr><td>Status Perkawinan</td><td>'+safe(content[0][15])+'</td></tr>'
      +'          <tr><td>Pekerjaan</td><td>'+safe(content[0][16])+'</td></tr>'
      +'          <tr><td>Kewarganegaraan</td><td>'+safe(content[0][17])+'</td></tr>'
      +'      </tbody></table></div>'
      +'  </div>'
      +'</div>',//////////////////////////////////////////////////////////////////////////////////////////////////
    closeByBackdropClick: false,
    destroyOnClose: true,
    verticalButtons: true,
    on: {
      opened: function () {
        //console.log('Dialog opened')
        let src = "https://drive.google.com/uc?export=view&id="+safe(data[13]);
        $$('#img').attr('src',src);
      }
    },
    buttons: [
      {
        text: 'Disetujui',
        close:true,
        color: 'green',
        onClick: function(dialog, e)
          {///////////////////////////////////////////////////////////////////////////////////////
            app.dialog.confirm('Apakah Anda yakin menyetujui permintaan verifikasi dari '+safe(data[4]), 'Konfirmasi', function ()
            {
              fpageverifikatorkeputusan(data[1],'disetujui','');              
            })
          }
      },
      {
        text: 'Tolak',
        close:true,
        onClick: function(dialog, e)
          {///////////////////////////////////////////////////////////////////////////////////////
            app.dialog.confirm('Apakah Anda yakin menolak permintaan verifikasi dari '+safe(data[4]), 'Konfirmasi', function ()
            {
              app.dialog.prompt('', 'Tambahkan Catatan', function (catatan){fpageverifikatorkeputusan(data[1],'ditolak',catatan);})
            })
          }
      },
      {
        text: 'Cancel',
        close:true,
        color: 'gray',
        onClick: function(dialog, e)
          {

          }
      },
    ]
  });
  dialog.open();
}

function fpageverifikatorkeputusan(uid,hasil,catatan)
{

  var verifikator = JSON.stringify({nama:dashboarddata.user.usernama,email:dashboarddata.user.useremail,uid:dashboarddata.user.useruid,catatan:catatan});

  let mypreloader = app.dialog.preloader();
  app.request({
    url: apidataurl,
    method: 'POST',
    cache: false,
    data : { token:mybsmiusertoken, command: 'verifikatoridentitaskeputusan', uid:uid,hasil:hasil,verifikator:verifikator}, 
    success: function (data, status, xhr)
      {
        mypreloader.close();
        var status = JSON.parse(data).status;
        var content = JSON.parse(data).data;
        if (status == "success")
        {
          
          //console.log(content);
          //fpageverifikator();
          $$('.mybsmi-verifikator-item-'+uid).hide();
          var toastBottom = app.toast.create({ text: content, closeTimeout: 2000,position: 'center', });toastBottom.open();
        }
        else if (status == "failed")
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
        else
        {
          //console.log("failed");
          app.dialog.alert(content,'Terjadi Kesalahan');
        }
      },
    error: function (xhr, status, message)
      {
        //console.log(message);
        app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
        mypreloader.close();
      },
  })
}
////////fpageverifikator//////////////////////////////////////////////


//////////myimage/////////////////////////////////////////
function myimage(data)
{
  var src=data.src;
  const para = document.createElement("div");
  para.innerHTML = '<div style="background: rgba(0, 0, 0, 0.8);position: fixed;z-index: 1000000000000000;align-items: center;justify-content: center;display: flex;bottom: 0;left: 0;right: 0;top: 0;"><img id="img" src="" style="border-radius: 1em;display: block;margin: auto;height: 90vh;width: 90vw;object-fit: contain;background-image:none;"></div>';
  
  para.addEventListener("click",()=>{
    para.remove(); 
  })

  document.body.appendChild(para);
  $$('#img').attr('src',src);

}
///////////myimage/////////////////////////////////////


/////////////////security///////////////////////////////////////
//https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html

//https://stackoverflow.com/questions/6234773/can-i-escape-html-special-chars-in-javascript
const escapeHTML = (unsafe) => {
    return unsafe.replaceAll('&', '&amp;').replaceAll('<', '&lt;').replaceAll('>', '&gt;').replaceAll('"', '&quot;').replaceAll("'", '&#039;');
}

//https://stackoverflow.com/posts/30970751/revisions
function escapehtmloldbrowser(s) {
    let lookup = {
        '&': "&amp;",
        '"': "&quot;",
        '\'': "&apos;",
        '<': "&lt;",
        '>': "&gt;"
    };
    return s.replace( /[&"'<>]/g, c => lookup[c] );
}

//https://stackoverflow.com/a/31637900
//encode all
function encodeall(e){return e.replace(/[^]/g,function(e){return"&#"+e.charCodeAt(0)+";"})}

//https://stackoverflow.com/a/34481254
//encode non alphanumeric
function encodenonalphanumeric( s )
{
    var h,
        i,
        n,
        c;

    n = s.length;
    h = '';

    for( i = 0; i < n; i++ )
    {
        c = s.charCodeAt( i );
        if( ( c >= 48 && c <= 57 ) 
          ||( c >= 65 && c <= 90 ) 
          ||( c >= 97 && c <=122 )
          ||( c == 32 ) )
        {
            h += String.fromCharCode( c );
        }
        else
        {
            h += '&#' + c + ';';
        }
    }

    return h;
}

function safe(unsafe)
{
unsafe = String(unsafe);
var data = escapeHTML(unsafe);
return data;

}

function safegetparam(unsafe)
{
var data = encodeURIComponent(unsafe)
return data;
}
/////////////////////////////////////////////////////////////////





///////fpageadmin();///////////////////////////////////////////
function fpageadmin()
{
  if (typeof mybsmiadmindata === 'undefined' || mybsmiadmindata === null)
  {
      let mypreloader = app.dialog.preloader();
      app.request({
        url: apidataurl,
        method: 'POST',
        cache: false,
        data : { token:mybsmiusertoken, command: 'getadmindata'}, 
        success: function (data, status, xhr)
          {
            mypreloader.close();
            var status = JSON.parse(data).status;
            var content = JSON.parse(data).data;
            if (status == "success")
            {
              //console.log(content);
              window.mybsmiadmindata = content;
              fpageadminrun(content);
            }
            else if (status == "failed")
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
            else
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
          },
        error: function (xhr, status, message)
          {
            //console.log(message);
            mypreloader.close();
            app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
          },
      })
  }
  else
  {
    fpageadminrun(mybsmiadmindata);
  }

  $$('.mybsmi-adminrefresh').on('click', function () {
    mybsmiadmindata = null
    fpageadmin()
  })
}

function fpageadminrun(content)
{
  var data = '<div class="data-table data-table-collapsible data-table-init"><table><thead><tr><th>Nama</th><th>Cabang</th><th>Profesi</th><th></th></tr></thead><tbody>';
  for (i=0;i<content.length;i++)
  {
      if ((content[i][2] === 'nuzulz+1@gmail.com')&&(mybsmiuseremail !== 'nuzulz@gmail.com')){continue;}else{if ((content[i][2] === 'nuzulz+1@gmail.com')&&(!isLocal)) continue;}
      
      if ((content[i][3] === 'Terbatas')||(content[i][3] === 'Terverifikasi')||(content[i][3] === 'Tertolak')){}else{continue;}
      
      data += '<tr class="mybsmi-admin-item-'+safe(content[i][1])+'"><td data-collapsible-title="Nama">'+safe(content[i][4])+'</td><td data-collapsible-title="Cabang">'+safe(content[i][11])+'</td><td data-collapsible-title="Profesi">'+safe(content[i][8])+'</td><td><a class="button button-fill mybsmi-adminaction" data-user="'+btoa(JSON.stringify(content[i]))+'">Detail</a></td></tr>';
  }
  data += '</tbody></table></div>';
  $$('.mybsmi-admin').html(data);

  $$('.mybsmi-admin a.mybsmi-adminaction').on('click', function (e) {
        
        //app.dialog.confirm('Pembuatan e-KTA memerlukan waktu 2-4 menit.', 'Pemberitahuan', function (){fbuatekta();})
        var base64 = this.attributes["data-user"].value;
        fpageadminidentitas(base64)
  });
}

function fpageadminidentitas(base64)
{
  var data = atob(base64);data = JSON.parse(data);
  var dialog = app.dialog.create({
    title: 'Data Relawan',
    content:''////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
      +'<div style="width:100%;height:50vh;overflow:auto;">'
      +'  <div style="display:flex;flex-direction:column;align-items:center;justify-content: center;">'
      +'      <img id="img" src="" style="width:150px;height:150px;margin: 10px 10px;border-radius: 50%;object-fit: cover;">'
      +'      <p style="font-weight:bold;"></p>'
      +'      <div class="data-table"><table><tbody>'
      +'          <tr><td>Nama</td><td>'+safe(data[4])+'</td></tr>'
      +'          <tr><td>Email</td><td>'+safe(data[2])+'</td></tr>'
      +'          <tr><td>Cabang</td><td>'+safe(data[11])+'</td></tr>'
      +'          <tr><td>Jenis Kelamin</td><td>'+safe(data[5])+'</td></tr>'
      +'          <tr><td>Alamat</td><td>'+safe(data[7])+'</td></tr>'
      +'          <tr><td>Profesi</td><td>'+safe(data[8])+'</td></tr>'
      +'          <tr><td>Golongan Darah</td><td>'+safe(data[9])+'</td></tr>'
      +'          <tr><td>No HP</td><td>'+safe(data[10])+'</td></tr>'
      +'          <tr><td>Tahun Bergabung</td><td>'+safe(data[12])+'</td></tr>'
      +'      </tbody></table></div>'
      +'  </div>'
      +'</div>',//////////////////////////////////////////////////////////////////////////////////////////////////
    closeByBackdropClick: false,
    destroyOnClose: true,
    verticalButtons: true,
    on: {
      opened: function () {
        //console.log('Dialog opened')
        let src = "https://drive.google.com/uc?export=view&id="+safe(data[13]);
        $$('#img').attr('src',src);
      }
    },
    buttons: [
      {
        text: 'Tutup',
        close:true,
        color: 'gray',
        onClick: function(dialog, e)
          {

          }
      },
    ]
  });
  dialog.open();
}
///////fpageadmin////////////////////////////////////////////////////////



/////fpagepesan//////////////////////////////////////////////////////////////
function fpagepesan()
{
  if (typeof mybsmipesan === 'undefined' || mybsmipesan === null)
  {
      let mypreloader = app.dialog.preloader();
      app.request({
        url: apidataurl,
        method: 'POST',
        cache: false,
        data : { token:mybsmiusertoken, command: 'getpesandata'}, 
        success: function (data, status, xhr)
          {
            mypreloader.close();
            var status = JSON.parse(data).status;
            var content = JSON.parse(data).data;
            if (status == "success")
            {
              //console.log(content);
              window.mybsmipesan = content;
              getpesandatarun(content)
            }
            else if (status == "failed")
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
            else
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
          },
        error: function (xhr, status, message)
          {
            //console.log(message);
            mypreloader.close();
            app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
          },
      })
  }
  else
  {
    getpesandatarun(mybsmipesan)
  }
}

function getpesandatarun(content)
{
  //console.log(content);
  $$('.mybsmi-pesan-masuk').html('');
  $$('.mybsmi-pesan-terkirim').html('');
  for(i=content.length-1;i>-1;i--)
  {
    //let date = new Date(content[i][0]).toLocaleString('en-US', { timeZone: 'Asia/Jakarta' });
    let date = new Intl.DateTimeFormat("id-ID", { hour12:false,dateStyle: "short" , timeStyle: "short",  timeZone: "Asia/Jakarta"}).format(new Date(content[i][0]));
    //let data = '<div class="timeline-item"><div class="timeline-item-date"><small>'+date+'</small></div><div class="timeline-item-divider"></div><div class="timeline-item-content"><div class="timeline-item-inner"><div class="timeline-item-time"></div><div class="timeline-item-text">'+safe(content[i][5])+'</div></div></div></div>';
    let data = ''
+'              <li class="mybsmi-pesan-item-'+safe(content[i][1])+'">'
+'                <a href="/bacapesan/'+i+'" class="item-content">'
+'                  <img src="avatar.png" style="width:40px;height:40px;margin-right:10px;border-radius:50% 50%;object-fit:cover;">'
+'                  <div class="item-inner">'
+'                    <div class="item-title-row">'
+'                      <div class="item-title text-color-gray">'+safe(content[i][3])+'</div>'
+'                      <div class="item-after">'+date+'</div>'
+'                    </div>'
+'                    <div class="item-subtitle text-color-gray">'+safe(content[i][7])+'</div>'
+'                    <div class="item-text">'+safe(content[i][8])+'</div>'
+'                  </div>'
+'                </a>'
+'              </li>'
    

    if (content[i][5] == dashboarddata.user.useruid)
    {
      $$('.mybsmi-pesan-masuk').append(data);
      $$('.mybsmi-pesan-item-'+content[i][1]+' img').attr('src','https://drive.google.com/uc?export=view&id='+safe(content[i][4]));
      if (content[i][9] == "false")
      {
        $$('.mybsmi-pesan-item-'+content[i][1]+' .item-title').removeClass('text-color-gray');
        $$('.mybsmi-pesan-item-'+content[i][1]+' .item-title').addClass('text-color-black');
        $$('.mybsmi-pesan-item-'+content[i][1]+' .item-subtitle').removeClass('text-color-gray');
        $$('.mybsmi-pesan-item-'+content[i][1]+' .item-subtitle').addClass('text-color-black');
      }
    }
    else if (content[i][2] == dashboarddata.user.useruid)
    {
      $$('.mybsmi-pesan-terkirim').append(data);
      $$('.mybsmi-pesan-item-'+content[i][1]+' img').attr('src','https://drive.google.com/uc?export=view&id='+safe(content[i][4]));
    }

  }
  
}

function fpagebacapesan(id)
{
    if (typeof mybsmipesan === 'undefined' || mybsmipesan === null) {
      app.views.main.router.navigate("/pesan/")
      return;
    }
    else
    {
      let data = mybsmipesan[id];
      let date = new Intl.DateTimeFormat("id-ID", { hour12:false,dateStyle: "short" , timeStyle: "short",  timeZone: "Asia/Jakarta"}).format(new Date(data[0]));
      let pengirim = ''
+'              <div class="list list-email media-list"><ul><li>'
+'                <label class="item-content">'
+'                  <img src="avatar.png" style="width:40px;height:40px;margin-right:10px;border-radius:50% 50%;object-fit:cover;">'
+'                  <div class="item-inner">'
+'                    <div class="item-title-row">'
+'                      <div class="item-title text-color-black">'+safe(data[3])+'</div>'
+'                      <div class="item-after">'+date+'</div>'
+'                    </div>'
+'                    <div class="item-subtitle text-color-gray">kepada '+safe(data[6])+'</div>'
+'                  </div>'
+'                </label>'
+'              </li></ul></div>'
      $$('.mybsmi-bacapesan .card-header').html(safe(data[7]));
      $$('.mybsmi-bacapesan .card-content').html(pengirim);
      $$('.mybsmi-bacapesan .card-footer').html(safe(data[8]))
      $$('.mybsmi-bacapesan img').attr('src','https://drive.google.com/uc?export=view&id='+safe(data[4]));
      if(data[5] === dashboarddata.user.useruid)
      {
        $$('.mybsmi-bacapesan .item-subtitle').html('kepada saya');
        if (data[9] === 'false')
        {
          mybsmipesan[id][9] = 'true';
          fupdatebacapesan(data[1]);
        }
      }
      
    }
}

function fupdatebacapesan(pesanid)
{
      //let mypreloader = app.dialog.preloader();
      app.request({
        url: apidataurl,
        method: 'POST',
        cache: false,
        data : { token:mybsmiusertoken, command: 'updatebacapesan', pesanid:pesanid}, 
        success: function (data, status, xhr)
          {
            //mypreloader.close();
            var status = JSON.parse(data).status;
            var content = JSON.parse(data).data;
            if (status == "success")
            {
              //console.log(content);
            }
            else if (status == "failed")
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
            else
            {
              //console.log("failed");
              app.dialog.alert(content,'Terjadi Kesalahan');
            }
          },
        error: function (xhr, status, message)
          {
            //console.log(message);
            //mypreloader.close();
            app.dialog.alert("Server sedang sibuk",'Terjadi Kesalahan');
          },
      })
}
/////fpagepesan//////////////////////////////////////////////////////////////
</script>
<!--end script------------------------------------------------------------------------------->  
</body>
</html>